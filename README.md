
Welcome to our python workflows for analysis of fiber photometry data acquired in tandem with Feeding Experimental Devices or FEDs. Our data is acquired using Neurophotometrics FP3002 systems but, in theory, any fiber photometry data that needs to be aligned to FED-generated timestamps can be analyzed using these workflows provided the photometry data and FED-data is converted to the appropriate input format. These fiber photometry analysis tools were developed by the Hardaway Lab  and MetaCell with input from Neurophotometrics. This modular pipeline will allow you to process your photometry data without the need to write code, and is broken into 3 main modules; signal processing (01), timestamp alignment (02), and signal pooling (03). They should be run in order. 


Currently, this suite only supports data recorded with FP3002 systems and the latest version of Neurophotometrics Bonsai software (0.6.0). To update to the latest NPM packages in Bonsai, please see instructions here: https://static1.squarespace.com/static/60ff345fca665d50e1adc805/t/6509eafc18f7817aef5b5404/1695148796487/Neurophotometrics.0.6.0+Update.pdf


The analysis pipeline consists of 3 separate notebooks designed to be run in order:

01.pipeline_process: this script imports raw data, crops a user-specified number of data points, deinterleaves and plots raw data, curve fits and normalizes data, plots normalized data, and writes out processed data in a universal format.

02.pipeline_align: this step imports timestamp data generated by keydown nodes, arduinos, and behavior cameras and aligns timestamps to photometry data

03.pipeline_pooling: the final step of the pipeline segments data around timestamps of interest, creates peri-event plots, and exports segmented data

FED3 COMPATIBILITY

Align photometry data to a multitude of FED3 events by editing the FED3 library to send TTL pulses of different pulsewidths to correspond to the event type.
It is recommended that you follow these conventions:

Pulse length Event

1 ms       pellet retrieval

2 ms       left poke

3 ms       right poke

4 ms       initiation of FED motor to deliver a pellet

5 ms       fall of pellet into magazine

6 ms       auditory cue

7 ms       LED strip activated
8 ms       open (users can configure these)
9 ms       open
10 ms      open
11 ms      open
12 ms      open
